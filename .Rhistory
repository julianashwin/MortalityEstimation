tibble(forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models (full)", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_fe2), fill = "Lee-Carter"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_fe2), fill = "Lee-Carter (StMoMo)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("Out-of-sample")
?fdm
model_cols <- c("Siler" = "purple", "Lee-Carter (demo)" = "red", "Lee-Carter (SMM)" = "deeppink",
"FDM" = "forestgreen", "CBD" = "darkorange1",
"Lee-Carter (dt)" = "gold", "Lee-Carter (dxt)" = "green",
"Lee-Carter (e0)" = "blue")
tibble(forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models (full)", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_fe2), fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_fe2), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("Out-of-sample")
fe_full_plt <-
tibble(forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_fe2), fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_fe2), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("Full sample")
fe_rolling_plt <-
tibble(int_forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_r_fe2), fill = "Lee-Carter"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_r_fe2), fill = "Lee-Carter (StMoMo)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_r_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_r_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_r_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_r_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_r_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("Rolling window")
ggarrange(fe_full_plt, fe_rolling_plt, nrow = 1, common.legend = T)
fe_rolling_plt <-
tibble(int_forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_r_fe2), fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_r_fe2), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_r_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_r_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_r_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_r_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_r_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("Rolling window")
ggarrange(fe_full_plt, fe_rolling_plt, nrow = 1, common.legend = T, legend = "right")
ggsave("figures_paper/BP_forecast_errors.pdf", width = 8, height = 4, device = cairo_pdf)
tibble(forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_r_fe2), fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_r_fe2), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_r_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_r_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_r_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_r_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_r_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("Rolling window")
fe_rolling_plt <-
tibble(forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_r_fe2), fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_r_fe2), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_r_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_r_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_r_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_r_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_r_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("Rolling window")
ggarrange(fe_full_plt, fe_rolling_plt, nrow = 1, common.legend = T, legend = "right")
ggsave("figures_paper/BP_forecast_errors.pdf", width = 8, height = 4, device = cairo_pdf)
ggsave("figures_paper/BP_forecast_errors.pdf", width = 8, height = 4, device = cairo_pdf)
tibble(forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_fe2), fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_fe2), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("Full sample")
fe_full_plt <-
tibble(forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_fe2), fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_fe2), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("Full sample")
fe_rolling_plt <-
tibble(forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_r_fe2), fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_r_fe2), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_r_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_r_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_r_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_r_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_r_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("Rolling window")
ggarrange(fe_full_plt, fe_rolling_plt, nrow = 1, common.legend = T, legend = "right")
ggsave("figures_paper/BP_forecast_errors.pdf", width = 8, height = 4, device = cairo_pdf)
fe_full_plt <-
tibble(forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_fe2), fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_fe2), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("Full sample")
fe_rolling_plt <-
tibble(forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_r_fe2), fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_r_fe2), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_r_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_r_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_r_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_r_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_r_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("Rolling window")
ggarrange(fe_full_plt, fe_rolling_plt, nrow = 1, common.legend = T, legend = "right")
ggsave("figures_paper/BP_forecast_errors.pdf", width = 8, height = 4, device = cairo_pdf)
increase_df <- all_pars_df %>%
filter(year %in% c(1988, 1998, 2008, 2018, 2028, 2038, 2048) &
parameter == "LE" &
name != "Russia" & name != "Ukraine") %>%
mutate(median = round(median, 1)) %>%
select(name, year, median) %>%
pivot_wider(id_cols = name, names_from = year, values_from = median) %>%
mutate(`1988-1998` = round(`1998`-`1988`, 3),
`1998-2008` = round(`2008`-`1998`, 3),
`2008-2018` = round(`2018`-`2008`, 3),
`2018-2028` = round(`2028`-`2018`, 3),
`2028-2038` = round(`2038`-`2028`, 3),
`2038-2048` = round(`2048`-`2038`, 3),
`2018-2048` = (`2048`-`2018`)/3,
`1988-2018` = (`2018`-`1988`)/3,
trend_change = (`2048`-`2018`)/3 - (`2018`-`1988`)/3) %>%
select(-`1988`, -`1998`, -`2008`, -`2018`, -`2028`, -`2038`, -`2048`) %>%
na.omit() %>%
pivot_longer(cols = -name, names_to = "Period", values_to = "Change")  %>%
mutate(Change_bucket = cut(Change, breaks = c(-Inf, 0, 0.5, 1, 1.5, 2, 2.5, Inf)))
increase_table <- table(select(increase_df, Period, Change_bucket))
increase_tab_df <- data.frame(matrix(increase_table, ncol = 7))
colnames(increase_tab_df) <- colnames(increase_table)
rownames(increase_tab_df) <- rownames(increase_table)
stargazer(as.matrix(increase_tab_df), table.placement = "H",
label = "intnlforecast", title = "Increases in LE (years per decade)")
tibble(forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = siler_fe, fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = LC_fe, fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = (LC_SMM_fe), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0, y = (LC_dt_fe), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = (LC_dxt_fe), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = (LC_e0_fe), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = (FDM_fe), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = (CBD_SMM_fe), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5)
tibble(forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = siler_fe, fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = LC_fe, fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = (LC_SMM_fe), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0, y = (LC_dt_fe), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = (LC_dxt_fe), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = (LC_e0_fe), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = (FDM_fe), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = (CBD_SMM_fe), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
xlab("Years ahead") + ylab("Mean Forecast error")+ ggtitle("Full sample")
tibble(int_forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = siler_fe, fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = LC_r_fe, fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = (LC_SMM_r_fe), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0, y = (LC_dt_r_fe), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = (LC_dxt_r_fe), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = (LC_e0_r_fe), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = (FDM_r_fe), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = (CBD_SMM_r_fe), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
xlab("Years ahead") + ylab("Mean Forecast error")+ ggtitle("Full sample")
tibble(int_forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = siler_fe, fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = LC_r_fe, fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = (LC_SMM_r_fe), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0, y = (LC_dt_r_fe), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = (LC_dxt_r_fe), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = (LC_e0_r_fe), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = (FDM_r_fe), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = (CBD_SMM_r_fe), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
xlab("Years ahead") + ylab("Mean Forecast error")+ ggtitle("Mean forecast error across all countries")
fe_mean_plt <-
tibble(int_forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = siler_fe, fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = LC_r_fe, fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = (LC_SMM_r_fe), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0, y = (LC_dt_r_fe), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = (LC_dxt_r_fe), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = (LC_e0_r_fe), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = (FDM_r_fe), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = (CBD_SMM_r_fe), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
xlab("Years ahead") + ylab("Mean Forecast error")+ ggtitle("Mean forecast error across all countries")
fe_rmse_plt <-
tibble(int_forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_r_fe2), fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_r_fe2), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_r_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_r_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_r_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_r_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_r_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("Rolling window")
ggarrange(fe_mean_plt, fe_rmse_plt, nrow = 1, common.legend = T, legend = "right")
fe_mean_plt <-
tibble(int_forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = siler_fe, fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = LC_r_fe, fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = (LC_SMM_r_fe), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0, y = (LC_dt_r_fe), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = (LC_dxt_r_fe), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = (LC_e0_r_fe), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = (FDM_r_fe), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = (CBD_SMM_r_fe), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
xlab("Years ahead") + ylab("Mean Forecast error")+ ggtitle("Bias")
fe_rmse_plt <-
tibble(int_forecasts_df) %>%
filter(age == 0 & n_ahead > 0) %>%
ggplot() + theme_bw() +
scale_fill_manual("Models", values = model_cols) +
geom_bar(aes(x = n_ahead-1.5, y = sqrt(siler_fe2), fill = "Siler"),
stat = "summary", fun = mean, width = 0.5) +
geom_bar(aes(x = n_ahead-1.0, y = sqrt(LC_r_fe2), fill = "Lee-Carter (demo)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead-0.5, y = sqrt(LC_SMM_r_fe2), fill = "Lee-Carter (SMM)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0, y = sqrt(LC_dt_r_fe2), fill = "Lee-Carter (dt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+0.5, y = sqrt(LC_dxt_r_fe2), fill = "Lee-Carter (dxt)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.0, y = sqrt(LC_e0_r_fe2), fill = "Lee-Carter (e0)"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+1.5, y = sqrt(FDM_r_fe2), fill = "FDM"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
geom_bar(aes(x = n_ahead+2.0, y = sqrt(CBD_SMM_r_fe2), fill = "CBD"),
stat = "summary", fun = mean, width = 0.5, alpha = 0.5) +
xlab("Years ahead") + ylab("RMSE")+ ggtitle("RMSE")
ggarrange(fe_mean_plt, fe_rmse_plt, nrow = 1, common.legend = T, legend = "right")
ggsave("figures_paper/BP_forecast_errors.pdf", width = 8, height = 4, device = cairo_pdf)
ggsave("figures_paper/country_forecast_errors.pdf", width = 8, height = 4, device = cairo_pdf)
names(int_forecasts_df)
mse_tab <- aggregate(c[obs,c("siler_fe2","LC_r_fe2", "LC_SMM_r_fe2", "LC_dt_r_fe2", "LC_dxt_r_fe2",
"LC_e0_r_fe2", "FDM_r_fe2", "CBD_r_fe2")],
by = list(name = country_forecasts_df$name[obs]), FUN = mean,)
obs <- which(!is.na(int_forecasts_df$siler_fe) & int_forecasts_df$age == 0 &
int_forecasts_df$est_year > 1960)
mse_tab <- aggregate(c[obs,c("siler_fe2","LC_r_fe2", "LC_SMM_r_fe2", "LC_dt_r_fe2", "LC_dxt_r_fe2",
"LC_e0_r_fe2", "FDM_r_fe2", "CBD_r_fe2")],
by = list(name = country_forecasts_df$name[obs]), FUN = mean,)
obs <- which(!is.na(int_forecasts_df$siler_fe) & int_forecasts_df$age == 0 &
int_forecasts_df$est_year > 1960)
mse_tab <- aggregate(int_forecasts_df[obs,c("siler_fe2","LC_r_fe2", "LC_SMM_r_fe2",
"LC_dt_r_fe2", "LC_dxt_r_fe2",
"LC_e0_r_fe2", "FDM_r_fe2", "CBD_r_fe2")],
by = list(name = country_forecasts_df$name[obs]), FUN = mean,)
int_forecasts_df[obs,c("siler_fe2","LC_r_fe2", "LC_SMM_r_fe2",
"LC_dt_r_fe2", "LC_dxt_r_fe2",
"LC_e0_r_fe2", "FDM_r_fe2", "CBD_r_fe2")]
c("siler_fe2","LC_r_fe2", "LC_SMM_r_fe2",
"LC_dt_r_fe2", "LC_dxt_r_fe2",
"LC_e0_r_fe2", "FDM_r_fe2", "CBD_r_fe2") %in% names(int_forecasts_df)
mse_tab <- aggregate(int_forecasts_df[obs,c("siler_fe2","LC_r_fe2", "LC_SMM_r_fe2",
"LC_dt_r_fe2", "LC_dxt_r_fe2",
"LC_e0_r_fe2", "FDM_r_fe2", "CBD_SMM_r_fe2")],
by = list(name = country_forecasts_df$name[obs]), FUN = mean,)
mse_tab <- aggregate(int_forecasts_df[obs,c("siler_fe2","LC_r_fe2", "LC_SMM_r_fe2",
"LC_dt_r_fe2", "LC_dxt_r_fe2",
"LC_e0_r_fe2", "FDM_r_fe2", "CBD_SMM_r_fe2")],
by = list(name = int_forecasts_df$name[obs]), FUN = mean,)
mse_tab
rownames(mse_tab) <- NULL
stargazer(mse_tab, summary = FALSE, title = "Mean Squared Forecast error by country",
label = "tab:country_mse", table.placement = "H")
mse_tab[,2:ncol(mse_tab)] <- sqrt(mse_tab[,2:ncol(mse_tab)])
stargazer(mse_tab, summary = FALSE, title = "Mean Squared Forecast error by country",
label = "tab:country_mse", table.placement = "H")
